<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.finalproject.mapper.UserMapper">

    <!--회원 가입-->
    <insert id="userRegister" parameterType="UserRegisterDto">
        INSERT INTO user(userName, email, phoneNo, password)
        VALUES (
                #{userName}, #{email}, #{phoneNo}, #{password}
                )
    </insert>

    <!--회원 여부 확인-->
    <select id="isMember" resultType="UserDto" parameterType="string">
        SELECT email, userName, password, isPermit, isLock, isPause, isQuit, roles, passwordChangeDate, lastLoginDate
        FROM user
        WHERE email like #{email}
    </select>

    <!--password 틀린 횟수 카운트-->
    <update id="passwordCount" parameterType="string">
        UPDATE user
        SET passwordCount = passwordCount+1
        WHERE email like #{email}
    </update>

    <!--비밀번호 틀린 횟수 리턴-->
    <select id="getPasswordCount" parameterType="string" resultType="Integer">
        SELECT passwordCount
        FROM user
        WHERE email like #{email}
    </select>

    <!--계정 잠금 설정-->
    <update id="accountLock" parameterType="string">
        UPDATE user
        SET isLock = 1
        WHERE email like #{email}
    </update>
</mapper>