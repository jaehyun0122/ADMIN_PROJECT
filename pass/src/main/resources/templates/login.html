<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<title>PASS 인증서</title>
</head>
<body>

<div class="wrap">

	<!-- header -->
	<!-- <div class="header">
	</div> -->
	<!-- //header -->

	<!-- content -->
	<div id="content">
		<div class="container">
			<div class="page_title">
				<div class="thum"><img src="https://via.placeholder.com/70" alt="이미지"></div>
				<div class="inner">
					<h2>국세청</h2>
					<p>이름/휴대폰번호를 입력하세요.</p>
				</div>
			</div>
			<div class="login_section">
				<div class="inner">
					<!-- <h2 class="tit">이름/휴대폰번호를 입력하세요.</h2> -->
					<p class="txt">입력 후, <span>PASS앱</span>을 통해 로그인합니다.</p>

					<div class="input_row"><!-- 오류시 error 추가 -->
						<div class="col"><span><input type="text" id="name" class="form_control" placeholder="이름" autocomplete="off"></span></div>
						<p id="nameErr" class="error_txt">이름을 바르게 입력해주세요. 잘못된 문자가 포함되어 있습니다.</p>
					</div>
					<div class="input_row"><!-- 오류시 error 추가 -->
						<div class="col">
							<span><input type="tel" id="birthday" class="form_control" maxlength="8" placeholder="생년월일 예) 19950122" autocomplete="off"></span>
						</div>
						<p id="birthErr" class="error_txt">생년월일을 바르게 입력해주세요. 잘못된 문자가 포함되어 있습니다.</p>
					</div>
					<div class="input_row"><!-- 오류시 error 추가 -->
						<div class="col" style="width: 20px">
							<span>
								<select name="gender" id="gender">
									<option disabled selected >성별</option>
									<option value="남">남</option>
									<option value="여">여</option>
								</select>
							</span>
						</div>
						<p id="genderErr" class="error_txt">!<span>성별을 체크해주세요.</span></p>
					</div>
					<div class="input_row telecom">
						<ul class="radio">
							<li class="on">
								<input type="radio" id="divide01" name="telCdRadio" checked="" value="SKT" class="telCdRadioSkt">
								<label class="fs20" for="divide01"><!-- SKT --><span></span></label>
							</li>
							<li class="">
								<input type="radio" id="divide02" name="telCdRadio" value="KT" class="telCdRadioKt">
								<label class="fs20" for="divide02"><!-- KT --><span></span></label>
							</li>
							<li class="">
								<input type="radio" id="divide03" name="telCdRadio" value="LGT" class="telCdRadioLgt">
								<label class="fs20" for="divide03"><!-- LG U+ --><span></span></label>
							</li>
						</ul>
					</div>
					<div class="input_row"><!-- 오류시 error 추가 -->
						<div class="col">
							<span><input type="text" id="phone_num" class="form_control" maxlength="11" placeholder="휴대폰 번호 11자리"  autocomplete="off"></span>
						</div>
						<p id="phoneErr" class="error_txt">!<span>휴대폰번호를 정확히 입력해주세요.</span></p>
					</div>

					<div class="agree">
						<div class="is_chkbox"><label for="chk1"><input type="checkbox" id="chk1"><span class="checkmark"></span>개인정보 제 3자 제공 동의(필수)</label><a href="join_agree.html" target="_blank" id="sample">내용보기</a></span></div>
					</div>

					<!-- <div class="join_step_btm"><p>선불폰, 14세 미만 사용자는 이용이 어렵습니다.</p></div> -->

					

					<script src='https://www.google.com/recaptcha/api.js'></script> 
					<style>
						.g-recaptcha {width:100%; margin-bottom:10px;}
					</style>
					<div class="g-recaptcha" data-sitekey="6LcePAATAAAAAGPRWgx90814DTjgt5sXnNbV5WaW"></div>

					<div class="auth_faq">
						<div class="item">
							<div class="q"><p><strong>인증서</strong> 사용에 어려움이 있으신가요?</p> <button type="button"><span>열고닫기</span></button></div>
							<div class="a">
								<div class="subtit"><span class="num">①</span> PASS 앱 설치 혹은 인증서 발급을 하셨나요?</div>
								<p>PASS인증서 이용을 위해선 PASS 앱 설치 및 PASS 인증서 발급 후 이용하실 수 있습니다.</p>

								<div class="subtit"><span class="num">②</span> 인증 요청을 했는데 오류가 발생한다고요?</div>
								<p>PASS 인증서 <a href="#g">자주묻는질문</a> 을 참고해주세요.</p>
							</div>
						</div>
					</div>

					
					<div class="btnG">
						<div><button type="button" class="ok"><span>다음</span></button></div>
					</div>
				</div>
			</div><!-- // login_section -->
		</div>
	</div>
	<!-- // content -->

</div>
<link rel="stylesheet" type="text/css" href="/css/common.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script>
$(document).ready(function(){
	$("div.telecom .radio li input[type='radio']").on("click", function(){
		$(this).parents().siblings().removeClass("on");
		$(this).parent("li").addClass("on");
	})
	$("div.telecom .radio li input[type='radio']").each(function(){
		if($(this).prop('checked')){
			$(this).parent("li").addClass("on");
		}else{
			$(this).parent("li").removeClass("on");
		}
	})

	$(".auth_faq div.q").on("click", function(){
		$(this).closest(".item").toggleClass("active")
	})


	/*$(".input_row input[type='text'], .input_row select").on("focus", function(){
		$(this).parents(".input_row").addClass("focus");
	})
	$(".input_row input[type='text'], .input_row select").on("focusout", function(){
		$(this).parents(".input_row").removeClass("focus");
	})*/

	// 다음 버튼 클릭
	$(".ok").click(function (){
		// 입력값 체크
		if(nameCheck() && birthCheck() && genderCheck() && phoneNumCheck()){
			let params = {
				userNm : $("#name").val(),
				birthday : $("#birthday").val(),
				telcoTycd: $('input[name="telCdRadio"]:checked').val(),
				phoneNo: $("#phone_num").val(),
				gender: $("#gender").val()
			}

			$.ajax({
				type: "GET",
				url : "/",
				data: params,
				success: function(data){
					$.ajax({
						type: "GET",
						url: "/join",
						data: data,
						success: function (data){
							sessionStorage.setItem("certTxId", data)
							location.href = "moveJoin";
						},
						error: function (){
							alert("join error")
						}
					})
				},
				error:function(){
					alert("login error")
				}
			}) // end ajax
		} // end 입력값 체크
	}) // end 다음 클릭

	/**
	 * 입력값 체크 함수. 생년월일, 휴대폰 번호 글자 수는 maxlength로 제한
 	 */
	// 이름 ( name, 한글만 )
	function nameCheck(){
		let korReg = /^[ㄱ-ㅎ|가-힣]+$/
		if(!korReg.test($("#name").val())){
			$("#nameErr").css("display", "inline")
			$("#name").focus()
			return false;
		}else{
			$("#nameErr").css("display", "none")
			return true;
		}
	}
	// 생년월일 ( birthday, 숫자 8자리 )
	function birthCheck(){
		let birthReg = /^[0-9]{8}/
		if(!birthReg.test($("#birthday").val())) {
			$("#birthErr").css("display", "inline")
			$("#birthday").focus()
			return false;
		}else{
			$("#birthErr").css("display", "none")
			return true;
		}
	}
	// 성별 ( gender, 남 또는 여 체크 확인 )
	function genderCheck(){
		if($("select[name='gender']").val() == null){
			$("#genderErr").css("display", "inline")
			$("#gender").focus()
			return false;
		}else{
			$("#genderErr").css("display", "none")
			return true;
		}
	}
	// 휴대폰 번호 ( phone_num, 숫자 11 자리 )
	function phoneNumCheck(){
		let phoneReg = /^01([0|1|6|7|8|9])([0-9]{3,4})([0-9]{4})$/;
		if(!phoneReg.test($("#phone_num").val())){
			$("#phoneErr").css("display", "inline")
			$("#phone_num").focus()
			return false;
		}else{
			$("#phoneErr").css("display", "none")
			return true
		}
	}

})
</script>

</body>
</html>
