<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.pass.dao.PassDao">
    <insert id="insertAuth"  parameterType="map">
        insert into req_info (
                              companyCd
                              ,channelTycd
                              ,channelNm
                              ,agencyCd
                              ,serviceTycd
                              ,telcoTycd
                              ,phoneNo
                              ,userNm
                              ,birthday
                              ,gender
                              ,reqTitle
                              ,reqContent
                              ,reqCSPhoneNo
                              ,reqEndDttm
                              ,isNotification
                              ,isPASSVerify
                              ,signTargetTycd
                              ,signTarget
                              ,isUserAgreement
                              ,originalInfo
                              ,isDigitalSign
                              ,isCombineAuth
                              ,certTxId
                              ,reqTxId)values (
                                         #{ReqDto.companyCd}
                                         ,#{ReqDto.channelTycd}
                                         ,#{ReqDto.channelNm}
                                        ,#{ReqDto.agencyCd}
                                        ,#{ReqDto.serviceTycd}
                                        ,#{ReqDto.telcoTycd}
                                        ,#{ReqDto.phoneNo}
                                        ,#{ReqDto.userNm}
                                        ,#{ReqDto.birthday}
                                        ,#{ReqDto.gender}
                                        ,#{ReqDto.reqTitle}
                                        ,#{ReqDto.reqContent}
                                        ,#{ReqDto.reqCSPhoneNo}
                                        ,#{ReqDto.reqEndDttm}
                                        ,#{ReqDto.isNotification}
                                        ,#{ReqDto.isPASSVerify}
                                        ,#{ReqDto.signTargetTycd}
                                        ,#{ReqDto.signTarget}
                                        ,#{ReqDto.isUserAgreement}
                                        ,#{ReqDto.originalInfo}
                                        ,#{ReqDto.isDigitalSign}
                                        ,#{ReqDto.isCombineAuth}
                                        ,#{ResDto.certTxId}
                                        ,#{ResDto.reqTxId})
    </insert>
    <select id="resultReq" parameterType="string" resultType="ResultReqDto">
        SELECT companyCd, reqTxId, certTxId, phoneNo, userNm
        FROM req_info
        WHERE certTxId = #{certTxId}
    </select>

    <insert id="insertAuthResult" parameterType="ResultReqDto">
        insert into auth_result(
                                reqTxId,
                                telcoTxId,
                                certTxId,
                                resultTycd,
                                resultDttm,
                                digitalSign,
                                ci,
                                userNm,
                                birthday,
                                gender,
                                phoneNo,
                                telcoTycd
        )
        values (
                #{reqTxId}
               , #{telcoTxId}
               , #{certTxId}
                , #{resultTycd}
                , #{resultDttm}
                , #{digitalSign}
               , #{ci}
               , #{userNm}
               , #{birthday}
               , #{gender}
               , #{phoneNo}
               , #{telcoTycd}
               )
    </insert>

    <select id="authResult" resultType="map" parameterType="string">
        select *
        from auth_result
        where certTxId = #{certTxId}
    </select>
</mapper>